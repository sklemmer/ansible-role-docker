language: python
python: "2.7"

services: docker

addons:
  apt:
    update: True
    packages:
      - python-apt

env:
  - ANSIBLE_CONFIG=tests/ansible.cfg ANSIBLE_VERSION=2.4 SUITE=default
  - ANSIBLE_CONFIG=tests/ansible.cfg ANSIBLE_VERSION=2.4 SUITE=docker_version
  - ANSIBLE_CONFIG=tests/ansible.cfg ANSIBLE_VERSION=2.5 SUITE=default
  - ANSIBLE_CONFIG=tests/ansible.cfg ANSIBLE_VERSION=2.5 SUITE=docker_version

install:
  - make install
script:
  - ansible-playbook --syntax-check -i tests/hosts tests/$(suite)/test.yml
  - ansible-playbook -i tests/hosts tests/$(suite)/test.yml
  - inspec exec tests/$(suite)/role_spec.rb
